webpackJsonp([58],{"1BPN":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("Gu7T"),s=o.n(n),a=o("qKdJ"),i={data:function(){return{option2:[],option1:[],checkStrictly:!1,menuList:[],showmenuList:[],dialog:!1,changeHandle:1,formSearch:{name:"",status:1},formPush:{},defaultProps:{children:"children",label:"name"},dataTree:[],formData:[],rules:{name:[{required:!0,message:"该项不能为空"}],orgId:[{required:!0,message:"该项不能为空",trigger:"blur"}],status:[{required:!0,message:"该项不能为空",trigger:"change"}]},defaultProps2:{children:"children",label:"name",value:"id",expandTrigger:"hover",checkStrictly:!0},defaultProps3:{children:"data",label:"name",value:"id",expandTrigger:"hover",checkStrictly:!0},bindMenu:{id:"",menuIds:[]},delTree:[]}},methods:{getList:function(){var e=this,t=sessionStorage.getItem("userId");Object(a._79)(t).then(function(t){console.log(t),200==t.data.code&&(e.formData=t.data.data)})},loadNode:function(e,t){if(0==e.level)return t(e.data);var o=e.data.data||[],n=e.data.children||[],a=[].concat(s()(o),s()(n));setTimeout(function(){t(a)},500)},getInit:function(){var e=this;this.getList();Object(a._68)({name:"",status:1}).then(function(t){console.log(t),200==t.data.code&&(e.dataTree=t.data.data)}),this.checkStrictly=!0,Object(a._64)({}).then(function(t){console.log(t),200==t.data.code&&(e.menuList=t.data.data)})},handleChange:function(e){this.formPush.orgId=this.option1[this.option1.length-1]},handleChange1:function(e){var t=this;this.checkStrictly=!0,this.bindMenu.id=this.option2[this.option2.length-1],Object(a.P)(this.bindMenu.id).then(function(e){console.log(e),200==e.data.code&&(t.showmenuList=e.data.data,t.$nextTick(function(){t.$refs.rightsTree.setCheckedKeys(t.showmenuList),t.checkStrictly=!1}),t.bindMenu.menuIds=t.showmenuList)})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},treeClick:function(e){this.option1=[],this.changeHandle=0,this.formPush=e,this.option1=[e.orgId],console.log(e)},addTree:function(e){var t=this;this.formPush.orgId?this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;Object(a.y)(t.formPush).then(function(e){console.log(e),200==e.data.code&&(t.$message({message:"添加成功",type:"success"}),t.getInit())})}):alert("请选择组织")},upTree:function(e){var t=this,o={id:this.formPush.id,name:this.formPush.name,orgId:this.formPush.orgId,status:this.formPush.status,description:this.formPush.description};this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;Object(a._118)(o).then(function(e){console.log(e),200==e.data.code&&(t.$message({message:"修改成功",type:"warning"}),t.getInit())})})},deleInfor:function(e){var t=this;console.log(e);var o=[e.id];this.$confirm("确认删除吗？").then(function(e){Object(a._12)(o).then(function(e){console.log(e),200==e.data.code&&(t.$message("删除成功"),t.getList())})}).catch(function(e){})},binding:function(){var e=this;console.log(this.bindMenu),Object(a.O)(this.bindMenu).then(function(t){console.log(t),200==t.data.code&&e.$message({message:"绑定成功",type:"success"}),e.dialog=!1})},handleCheckChange:function(e,t){console.log(t),this.bindMenu.menuIds=this.$refs.rightsTree.getCheckedKeys().concat(this.$refs.rightsTree.getHalfCheckedKeys()),console.log(this.$refs.rightsTree.getCheckedKeys().concat(this.$refs.rightsTree.getHalfCheckedKeys()),"dfdff")},getTreeArr:function(e,t){this.option1.unshift(e)}},mounted:function(){this.getInit()}},r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",[o("div",{staticClass:"cont_box"},[o("div",{staticClass:"cont_box_left"},[o("el-form",{staticClass:"margin10",attrs:{inline:!0,model:e.formSearch}},[o("el-form-item",{attrs:{label:""}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog=!0}}},[e._v("角色绑定")])],1),e._v(" "),o("el-form-item",{attrs:{label:""}},[o("el-button",{attrs:{type:"warning"},on:{click:function(t){e.changeHandle=1,e.getList,e.formPush={}}}},[e._v("重置")])],1),e._v(" "),o("el-form-item",{attrs:{label:""}})],1),e._v(" "),o("el-tree",{attrs:{data:e.formData,props:e.defaultProps,load:e.loadNode,lazy:"","node-key":"id","filter-node-method":e.filterNode,"expand-on-click-node":!1},on:{"node-click":e.treeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,s=t.data;return o("div",{staticClass:"custom-tree-node"},[o("span",[e._v(e._s(n.label))]),e._v(" "),s.parentId||0==s.parentId?e._e():o("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"danger",size:"mini"},on:{click:function(){return e.deleInfor(s)}}},[e._v(" 删除 ")])],1)}}])})],1),e._v(" "),o("div",{staticClass:"cont_box_right"},[o("el-form",{staticClass:"marginRight",attrs:{inline:!0,model:e.formSearch}},[o("el-form-item",{staticStyle:{margin:"0px"},attrs:{label:1==e.changeHandle?"新增":"修改"}})],1),e._v(" "),o("el-form",{ref:"formPush",attrs:{"label-position":"right",rules:e.rules,"label-width":"80px",model:e.formPush}},[o("el-form-item",{attrs:{label:"所属组织",size:"small",prop:"orgId"}},[o("el-cascader",{ref:"cascader",attrs:{options:e.dataTree,props:e.defaultProps2,clearable:""},on:{change:e.handleChange},model:{value:e.option1,callback:function(t){e.option1=t},expression:"option1"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[o("el-input",{model:{value:e.formPush.name,callback:function(t){e.$set(e.formPush,"name",t)},expression:"formPush.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.formPush.description,callback:function(t){e.$set(e.formPush,"description",t)},expression:"formPush.description"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"状态",prop:"status"}},[o("el-radio-group",{model:{value:e.formPush.status,callback:function(t){e.$set(e.formPush,"status",t)},expression:"formPush.status"}},[o("el-radio",{attrs:{label:!0}},[e._v("启用")]),e._v(" "),o("el-radio",{attrs:{label:!1}},[e._v("禁止")])],1)],1),e._v(" "),o("el-form-item",[1==e.changeHandle?o("el-button",{attrs:{size:"medium "},on:{click:function(t){return e.addTree("formPush")}}},[e._v("新增")]):o("el-button",{attrs:{size:"medium ",type:"warning"},on:{click:function(t){return e.upTree("formPush")}}},[e._v("修改")])],1)],1)],1)]),e._v(" "),o("el-dialog",{attrs:{title:"菜单绑定",visible:e.dialog},on:{"update:visible":function(t){e.dialog=t}}},[o("div",{staticClass:"cont_box_right"},[o("el-form",{ref:"addList",attrs:{"label-position":"right",rules:e.rules,"label-width":"90px",model:e.formPush}},[o("el-form-item",{attrs:{label:"角色",size:"small"}},[o("el-cascader",{ref:"cascader",attrs:{options:e.formData,props:e.defaultProps3,clearable:""},on:{change:e.handleChange1},model:{value:e.option2,callback:function(t){e.option2=t},expression:"option2"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"菜单",size:"small"}},[o("el-tree",{ref:"rightsTree",attrs:{data:e.menuList,props:e.defaultProps,"check-strictly":e.checkStrictly,"show-checkbox":"","default-expanded-keys":e.showmenuList,"default-checked-keys":e.showmenuList,"node-key":"id"},on:{check:e.handleCheckChange}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"medium "},on:{click:function(t){e.dialog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{size:"medium "},on:{click:function(t){return e.binding()}}},[e._v("绑 定")])],1)])],1)},staticRenderFns:[]};var l=o("VU/8")(i,r,!1,function(e){o("lfOY")},"data-v-4b945d36",null);t.default=l.exports},lfOY:function(e,t){}});
//# sourceMappingURL=58.a49880415030c8f54313.js.map