webpackJsonp([60],{N9Xp:function(t,e){},rCn5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("prc4"),n=a("f9k7"),l=a("sSIQ"),i=a("ZFl+"),r=a("qKdJ"),s={props:["showBtnFather"],data:function(){return{mapOpints:"",mapDialog:!1,showAddBtn:1!=this.showBtnFather,showDelBtn:!0,formItems:{formItemsArr:[{name:"开始运行时间",filed:"runTime",type:"datePicker"},{name:"姓名",filed:"name",type:"text"}],labelWidth:"100px"},deleBatch:[],formSearch:{current:1,size:10},formPush:{items:[]},formData:[],formUpdate:{},total:0,addDialog:!1,updateDialog:!1,rules:{name:[{required:!0,message:"该项不能为空",trigger:"change"}],coverImg:[{required:!0,message:"该项不能为空",trigger:"change"}],coverVideo:[{required:!0,message:"该项不能为空",trigger:"change"}]},mapObj:"",markerObj:"",opintsArr:[],opintsArr1:[]}},methods:{aa:function(){var t=this;setTimeout(function(e){t.opintsArr=t.opintsArr1,console.log(t.opintsArr)},5e3)},mapOpintsArr:function(t){var e=this;this.mapOpints="",this.formPush.items=t,0!=t.length&&t.forEach(function(t){e.mapOpints=t.name+","+e.mapOpints}),this.mapDialog=!1},upshDevInfor:function(){this.$emit("getDevIds",this.deleBatch)},initTmap:function(){var t=this;i.a.init().then(function(e){var a=new e.LatLng(22.831779,114.980945),o=new e.Map("container",{rotation:20,pitch:0,zoom:17,center:a});e.ImageTileLayer.createCustomLayer({layerId:"5f6b13185922",map:o}).then(function(t){t||console.log("fail")}),t.mapObj=o;var n=new e.MultiMarker({id:"marker-layer",map:o});t.markerObj=n,o.on("click",function(e){console.log(e),t.formPush.latitude=e.latLng.getLat(),t.formPush.longitude=e.latLng.getLng(),n.add({position:e.latLng}),console.log(e.latLng.getLng()+","+e.latLng.getLat())})})},getlist:function(){var t=this;Object(r._66)(this.formSearch).then(function(e){console.log(e),200==e.data.code?(t.formData=e.data.data.records.filter(function(t){return t}),t.total=e.data.data.total):t.$message(e.data.msg)})},getInit:function(){this.getlist()},addList:function(t){var e=this;this.formPush.items.length==this.formPush.num?this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;Object(r.l)(e.formPush).then(function(t){console.log(t),200==t.data.code?(e.getlist(),e.$message({message:"添加成功",type:"success"})):e.$message("添加失败")}),e.addDialog=!1}):this.$message("点位和数量必须相等")},updateList:function(t){var e=this;console.log(this.formUpdate),this.formUpdate.items.length==this.formUpdate.num?this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;Object(r._14)(e.formUpdate).then(function(t){console.log(t),200==t.data.code&&(e.$message({message:"修改成功",type:"warning"}),e.getlist())}),e.updateDialog=!1}):this.$message("点位和数量必须相等")},deleInfor:function(t){var e=this,a=[];t&&a.push(t),0!=this.deleBatch.length&&this.deleBatch.filter(function(t){return a.push(t.id),t}),this.$confirm("确认删除吗？").then(function(t){Object(r.W)(a).then(function(t){console.log(t),200==t.data.code&&(e.$message("删除成功"),e.getlist())})}).catch(function(t){})},handleSelectionChange:function(t,e){this.deleBatch=t},handleCurrentPage:function(t){this.formSearch.current=t,this.getlist()},updateShowBox:function(t){var e=this;this.mapOpints="",this.formUpdate={items:t.items,name:t.name,id:t.id,num:t.num,runTime:t.runTime,serial:t.serial,type:t.type,longitude:t.longitude,latitude:t.latitude},this.opintsArr1=t.items.filter(function(t){return e.mapOpints=t.name+","+e.mapOpints,t}),console.log(this.formUpdate,this.opintsArr)},getMuchDeleteType:function(t){this.deleInfor(t)},getAddTotrue:function(t){this.addDialog=t,this.mapObj},getSearchInfor:function(t){this.formSearch=t,this.getlist()}},mounted:function(){console.log(this.showBtnFather),this.getInit()},components:{paging:o.a,mapPoints:n.default,searchModule:l.a}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"modlude"},[a("searchModule",{attrs:{formItems:t.formItems,showAddBtn:t.showAddBtn,showDelBtn:t.showDelBtn},on:{muchDeleteType:t.getMuchDeleteType,searchInfor:t.getSearchInfor,addTotrue:t.getAddTotrue}}),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.formData,stripe:""},on:{select:t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"地址"}}),t._v(" "),a("el-table-column",{attrs:{prop:"runTime",label:"开始运行时间"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.runTime?[t._v("\n          "+t._s(t.$root.getDateArray(Number(e.row.runTime))[9])+"\n        ")]:void 0}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"gmtModified",label:"修改时间"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.gmtModified?[t._v("\n          "+t._s(t.$root.getDateArray(Number(e.row.gmtModified))[9])+"\n        ")]:void 0}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"gmtCreate",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.gmtCreate?[t._v("\n          "+t._s(t.$root.getDateArray(e.row.gmtCreate)[9])+"\n        ")]:void 0}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"isDel",label:"是否已删除"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(1==e.row.isDel?"是":"否")+"\n        ")]}}])}),t._v(" "),t.showBtnFather?t._e():a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){t.updateShowBox(e.row),t.updateDialog=!0}}},[t._v("修 改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return t.deleInfor(e.row.id)}}},[t._v("删 除")])]}}],null,!1,2045735990)})],1),t._v(" "),a("paging",{attrs:{"get-total":t.total},on:{changePage:t.handleCurrentPage}}),t._v(" "),t.showBtnFather?a("div",{staticClass:"export_template",staticStyle:{"margin-bottom":"20px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.upshDevInfor}},[t._v("确 定")])],1):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"新增",visible:t.addDialog},on:{"update:visible":function(e){t.addDialog=e}}},[a("div",{staticClass:"cont_box_left"},[a("el-form",{ref:"addList",attrs:{"label-position":"right","label-width":"110px",model:t.formPush,rules:t.rules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:t.formPush.name,callback:function(e){t.$set(t.formPush,"name",e)},expression:"formPush.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"数量"}},[a("el-input",{model:{value:t.formPush.num,callback:function(e){t.$set(t.formPush,"num",e)},expression:"formPush.num"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始运行时间"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",placeholder:"开始运行时间"},model:{value:t.formPush.runTime,callback:function(e){t.$set(t.formPush,"runTime",e)},expression:"formPush.runTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{model:{value:t.formPush.type,callback:function(e){t.$set(t.formPush,"type",e)},expression:"formPush.type"}},[a("el-option",{attrs:{label:"水设备",value:1}}),t._v(" "),a("el-option",{attrs:{label:"电设备",value:2}}),t._v(" "),a("el-option",{attrs:{label:"安保",value:3}}),t._v(" "),a("el-option",{attrs:{label:"卫生",value:4}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"地图点位"}},[a("el-input",{model:{value:t.mapOpints,callback:function(e){t.mapOpints=e},expression:"mapOpints"}}),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.mapDialog=!0}}},[t._v("选 择")])],1)],1),t._v(" "),a("el-form",{attrs:{"label-position":"right","label-width":"110px"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium "},on:{click:function(e){t.addDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"medium "},on:{click:function(e){return t.addList("addList")}}},[t._v("新 增")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"修改",visible:t.updateDialog},on:{"update:visible":function(e){t.updateDialog=e}}},[a("div",{staticClass:"cont_box_left"},[a("el-form",{ref:"formUpdate",attrs:{"label-position":"right",rules:t.rules,"label-width":"110px",model:t.formUpdate}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:t.formUpdate.name,callback:function(e){t.$set(t.formUpdate,"name",e)},expression:"formUpdate.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"数量"}},[a("el-input",{model:{value:t.formUpdate.num,callback:function(e){t.$set(t.formUpdate,"num",e)},expression:"formUpdate.num"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始运行时间"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",placeholder:"开始运行时间"},model:{value:t.formUpdate.runTime,callback:function(e){t.$set(t.formUpdate,"runTime",e)},expression:"formUpdate.runTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{model:{value:t.formUpdate.type,callback:function(e){t.$set(t.formUpdate,"type",e)},expression:"formUpdate.type"}},[a("el-option",{attrs:{label:"水设备",value:1}}),t._v(" "),a("el-option",{attrs:{label:"电设备",value:2}}),t._v(" "),a("el-option",{attrs:{label:"安保",value:3}}),t._v(" "),a("el-option",{attrs:{label:"卫生",value:4}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"地图点位"}},[a("el-input",{model:{value:t.mapOpints,callback:function(e){t.mapOpints=e},expression:"mapOpints"}}),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.mapDialog=!0,t.aa()}}},[t._v("选 择")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.updateDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.updateList("formUpdate")}}},[t._v("确定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"地图",visible:t.mapDialog},on:{"update:visible":function(e){t.mapDialog=e}}},[a("div",{staticClass:"cont_box_left"},[a("mapPoints",{attrs:{opintsArr:t.opintsArr},on:{mapOpintsArr:t.mapOpintsArr}})],1)])],1)},staticRenderFns:[]};var u=a("VU/8")(s,m,!1,function(t){a("N9Xp")},"data-v-37b9fc1d",null);e.default=u.exports}});
//# sourceMappingURL=60.c0b715aac187dcbac4f0.js.map